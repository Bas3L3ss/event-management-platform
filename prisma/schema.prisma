// prisma/schema.prisma

datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  directUrl         = env("DIRECT_URL")
}
generator client {
  provider = "prisma-client-js"
}


model User {
  id               String         @id @default(uuid())
  clerkId          String         @unique
  userName         String
  userBiography    String
  userAvatar       String
  accountCreatedAt DateTime       @default(now())
  updatedAt DateTime @updatedAt
  deletedAt DateTime 
  isAuthorizedUser Boolean        @default(false)
  followers        String[]       @default([])
  followedByUsers  String[]       @default([])

  notifications    Notification[] @relation("UserNotifications") // Back-relation

  @@index([accountCreatedAt])
}

model Notification {
  id                     String   @id @default(uuid())
  clerkId                String
  userAvatar             String
  description            String
  title                  String
  notificationCreatedAt  DateTime @default(now())
  seenStatus Boolean @default(false)
  userId                 String
  user                   User     @relation("UserNotifications", fields: [userId], references: [id])

  @@index([notificationCreatedAt])
}

model Comment {
  id          String   @id @default(uuid())
  clerkId     String    
  authorName  String
  authorImageUrl String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  eventId     String
  rating Float

  event       Event    @relation("EventComments", fields: [eventId], references: [id])

  @@index([createdAt])
}

model Event {
  id               String     @id @default(uuid())
  clerkId          String 
  eventName        String
  eventDescription String
  dateEnd        DateTime 
  dateStart DateTime
  status           EventStatus
  type EventType
  rating           Float @default(0)
  eventImg         String[] @default([]) 
  eventVideo String?
  eventImgOrVideoFirstDisplay String?
  eventTicketPrice Float
  eventTicketCurrency String
  eventLocation String 
  reservationTicket String @default("")

  featured         Boolean     @default(false)
  comments         Comment[]   @relation("EventComments")
  hostName         String?

@@index([dateStart, dateEnd])
}

model Order {
  id        String   @id @default(uuid())
  clerkId   String
  orderTotal Int      @default(0)
  email     String
  isPaid    Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum EventStatus {
  NOT_CONFIRMED
  UPCOMING
  STARTED
  ENDED
}


enum EventType {
  CONFERENCE
  SEMINARS_WORKSHOPS
  SPORTS
  WEDDINGS_CELEBRATION
  FASHION
  CONCERTS
  MEETINGS
  FESTIVALS
  TRADE_SHOWS_EXPOS
  FUNDRAISERS_CHARITY
  NETWORKING
  PRODUCT_LAUNCHES
  CORPORATE_RETREATS
}